import java.util.Scanner;

public class MainCenso {
    private static Censo censo = new Censo();
    private static Scanner sc = new Scanner(System.in);
    
    public static void main(String[] args) {
        int opcion;
        do {
            mostrarMenu();
            try {
                opcion = Integer.parseInt(sc.nextLine());
            } catch (NumberFormatException e) {
                System.out.println("Ingrese una opción válida.");
                continue;
            }
            
            switch (opcion) {
                case 1:
                    registrarCiudadano();
                    break;
                case 2:
                    eliminarRegistro();
                    break;
                case 3:
                    censo.mostrarCenso();
                    break;
                case 4:
                    exportarDatos();
                    break;
                case 5:
                    importarDatos();
                    break;
                case 6:
                    System.out.println("Saliendo del programa...");
                    break;
                default:
                    System.out.println("Opción inválida. Intente nuevamente.");
            }
        } while (opcion != 6);
    }
    
    // Muestra el menú principal.
    private static void mostrarMenu() {
        System.out.println("=== CENSO DE MEDELLÍN ===");
        System.out.println("1. Registrar ciudadano");
        System.out.println("2. Eliminar ciudadano (atender en orden)");
        System.out.println("3. Mostrar todos los registros");
        System.out.println("4. Exportar datos a CSV");
        System.out.println("5. Importar datos desde CSV");
        System.out.println("6. Salir");
        System.out.print("Ingrese una opción: ");
    }
    
    // Lee los datos del ciudadano y lo registra.
    private static void registrarCiudadano(){
        try {
            System.out.print("Ingrese nombre: ");
            String nombre = sc.nextLine();
            
            System.out.print("Ingrese cédula: ");
            String cedula = sc.nextLine();
            
            System.out.print("Ingrese edad: ");
            int edad = Integer.parseInt(sc.nextLine());
            
            System.out.print("¿Es desplazado? (true/false): ");
            boolean esDesplazado = Boolean.parseBoolean(sc.nextLine());
            
            System.out.print("Ingrese estrato (1-6): ");
            int estrato = Integer.parseInt(sc.nextLine());
            
            Registro reg = new Registro(nombre, cedula, edad, esDesplazado, estrato);
            censo.agregarRegistro(reg);
            System.out.println("Registro agregado correctamente.");
        } catch(NumberFormatException nfe){
            System.out.println("Error en el formato de alguno de los datos. Intente nuevamente.");
        } catch(IllegalArgumentException iae){
            System.out.println("Error de validación: " + iae.getMessage());
        }
    }
    
    // Elimina (atiende) el ciudadano en la cabeza de la cola.
    private static void eliminarRegistro(){
        Registro reg = censo.eliminarRegistro();
        if(reg != null){
            System.out.println("Registro eliminado: " + reg);
        } else {
            System.out.println("No hay registros para eliminar.");
        }
    }
    
    // Exporta los datos a un archivo CSV definido por el usuario.
    private static void exportarDatos(){
        System.out.print("Ingrese la ruta y nombre del archivo (por ejemplo, exportacion.csv): ");
        String ruta = sc.nextLine();
        censo.exportarAHCSV(ruta);
    }
    
    // Importa datos desde un archivo CSV definido por el usuario.
    private static void importarDatos(){
        System.out.print("Ingrese la ruta y nombre del archivo (por ejemplo, importacion.csv): ");
        String ruta = sc.nextLine();
        censo.importarDesdeCSV(ruta);
    }
}